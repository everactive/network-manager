summary: Verify aliases provided by the snap are correctly enabled

execute: |
    # FIXME: Aliases should be not in place automatically unless we
    # have them approved from the store in our snap-declaration assertion.
    test ! -e /snap/bin/nmcli

    snapd_version=$(snap version | awk '/^snapd / {print $2; exit}')
    target=$SNAP_NAME.nmcli
    if dpkg --compare-versions $snapd_version lt 2.25 ; then
        target=$SNAP_NAME
    fi
    snap alias $target nmcli

    test -e /snap/bin/nmcli

    # Verify the alias works without any problems
    /snap/bin/nmcli g
