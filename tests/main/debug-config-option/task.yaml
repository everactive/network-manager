summary: Test network-manager snap debug configuration

execute: |
    test "$(snap get network-manager debug.enable)" = "false"

    snap set network-manager debug.enable=true
    test "$(snap get network-manager debug.enable)" = "true"
    test -e /var/snap/network-manager/current/.debug_enabled
    ps -ef | grep -z "NetworkManager.*\-\-debug" | grep -v grep
    journalctl --no-pager -u snap.network-manager.networkmanager.service | grep -Pzq "<debug>"

    snap set network-manager debug.enable=false
    test "$(snap get network-manager debug.enable)" = "false"
    test ! -e /var/snap/network-manager/current/.debug_enabled
    ! journalctl --no-pager -u snap.network-manager.networkmanager.service | grep -Pzq "<debug>"
