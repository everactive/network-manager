#!/bin/bash

set -e
set -x

escape() {
    echo "$*" | sed "s/'/'\"'\"'/g; s/.*/'&'/"
}

run=""
while [ $# -gt 0 ]; do
  case $1 in
    -sf|-pf|-lf|-cf)
      case $2 in
        /*)
          path=$2
        ;;
        *)
          path=$PWD/$2
        ;;
      esac
      run="$run $1 `escape $path`"
      shift 2
    ;;
    *)
      run="$run `escape $1`"
      shift
    ;;
  esac
done

eval exec $0.real $run
